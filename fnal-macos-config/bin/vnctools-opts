#!/usr/bin/env bash

# parse the command line arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        --config-file=*)
            config_file="${1#*=}"
            shift
            ;;
        --display=*)
            display="${1#*=}"
            shift
            ;;
        --geometry=*)
            geometry="${1#*=}"
            shift
            ;;
        --hostname=*)
            hostname="${1#*=}"
            shift
            ;;
        --localport=*)
            localport="${1#*=}"
            shift
            ;;
        --username=*)
            username="${1#*=}"
            shift
            ;;
        --realvnc)
            flag_realvnc=true;
            shift
            ;;
        --screenshare)
            flag_screenshare=true;
            shift
            ;;
        --)
            shift
            extra_args="$@";
            break
            ;;
        *)
            echo "Unknown option $1"
            return 1 2>/dev/null; exit 1;
            shift
            ;;
    esac
done

if [[ ! -z ${config_file+_} ]]; then
    echo "Loading configuration ${config_file}"
    cat ${config_file}
    echo
    source ${config_file}
fi
username=${username:=$(whoami)}
